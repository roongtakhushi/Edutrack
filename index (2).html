<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Edutrack - Login</title>
    <style>
        :root {
            --primary: #B12F49;
            --secondary: #384358;
            --accent: #FFA586;
            --light: #f8f9fa;
            --dark: #343a40;
            --success: #28a745;
            --warning: #ffc107;
            --danger: #dc3545;
            --info: #17a2b8;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #f5f5f5;
            color: var(--secondary);
            min-height: 100vh;
        }

        /* Login Page Styles */
        .login-container {
            display: flex;
            width: 100%;
            height: 100vh;
        }

        .login-left {
            flex: 1;
            background-color: var(--secondary);
            color: white;
            display: flex;
            flex-direction: column;
            justify-content: center;
            padding: 40px;
        }

        .login-right {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            padding: 40px;
            background-color: white;
        }

        .login-logo {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 20px;
            color: var(--accent);
        }

        .login-tagline {
            font-size: 1.2rem;
            margin-bottom: 40px;
            opacity: 0.9;
        }

        .login-features {
            list-style: none;
        }

        .login-features li {
            margin-bottom: 15px;
            display: flex;
            align-items: center;
        }

        .login-features i {
            margin-right: 10px;
            font-size: 1.2rem;
        }

        .login-form-container {
            max-width: 400px;
            width: 100%;
            margin: 0 auto;
        }

        .login-title {
            font-size: 2rem;
            margin-bottom: 10px;
            color: var(--secondary);
        }

        .login-subtitle {
            margin-bottom: 30px;
            color: #666;
        }

        .login-tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 1px solid #ddd;
        }

        .login-tab {
            padding: 10px 20px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
        }

        .login-tab.active {
            border-bottom: 3px solid var(--primary);
            color: var(--primary);
            font-weight: 500;
        }

        .login-form {
            display: none;
        }

        .login-form.active {
            display: block;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            color: var(--secondary);
        }

        input {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 1rem;
        }

        input:focus {
            outline: none;
            border-color: var(--accent);
        }

        .btn {
            padding: 12px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 500;
            transition: all 0.3s;
            width: 100%;
        }

        .btn-primary {
            background-color: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background-color: #9a2840;
        }

        .demo-credentials {
            margin-top: 20px;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 4px;
            font-size: 0.9rem;
        }

        .demo-credentials h4 {
            margin-bottom: 10px;
            color: var(--secondary);
        }

        .hidden {
            display: none;
        }

        @media (max-width: 768px) {
            .login-container {
                flex-direction: column;
            }
            
            .login-left, .login-right {
                padding: 20px;
            }
        }

        /* Dashboard Styles */
        .dashboard-container {
            display: none;
            width: 100%;
        }

        /* Your existing CSS styles continue below... */
        :root {
            --primary: #B12F49;
            --secondary: #384358;
            --accent: #FFA586;
            --light: #f8f9fa;
            --dark: #343a40;
            --success: #28a745;
            --warning: #ffc107;
            --danger: #dc3545;
            --info: #17a2b8;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #f5f5f5;
            color: var(--secondary);
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar Styles */
        .sidebar {
            width: 250px;
            background-color: var(--secondary);
            color: white;
            height: 100vh;
            position: fixed;
            overflow-y: auto;
            transition: all 0.3s;
            z-index: 1000;
        }

        .sidebar-header {
            padding: 20px;
            background-color: var(--primary);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .sidebar-header h2 {
            font-size: 1.5rem;
            font-weight: 600;
        }

        .sidebar-menu {
            padding: 15px 0;
        }

        .sidebar-menu ul {
            list-style: none;
        }

        .sidebar-menu li {
            margin-bottom: 5px;
        }

        .sidebar-menu a {
            display: flex;
            align-items: center;
            padding: 12px 20px;
            color: white;
            text-decoration: none;
            transition: all 0.3s;
        }

        .sidebar-menu a:hover, .sidebar-menu a.active {
            background-color: rgba(255, 255, 255, 0.1);
            border-left: 4px solid var(--accent);
        }

        .sidebar-menu i {
            margin-right: 10px;
            font-size: 1.2rem;
        }

        /* Main Content Styles */
        .main-content {
            flex: 1;
            margin-left: 250px;
            padding: 20px;
            transition: all 0.3s;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            margin-bottom: 20px;
            border-bottom: 1px solid #e0e0e0;
        }

        .header h1 {
            color: var(--primary);
            font-size: 1.8rem;
        }

        .user-profile {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: var(--accent);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        /* Card Styles */
        .card {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
            overflow: hidden;
        }

        .card-header {
            padding: 15px 20px;
            background-color: var(--secondary);
            color: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .card-body {
            padding: 20px;
        }

        /* Dashboard Stats */
        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            padding: 20px;
            text-align: center;
            transition: transform 0.3s;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-card h3 {
            font-size: 2rem;
            color: var(--primary);
            margin-bottom: 10px;
        }

        .stat-card p {
            color: var(--secondary);
            font-weight: 500;
        }

        /* Pending Tasks Styles */
        .pending-tasks-list {
            margin-top: 15px;
        }

        .task-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid #eee;
        }

        .task-item:last-child {
            border-bottom: none;
        }

        .task-info {
            display: flex;
            flex-direction: column;
        }

        .task-class {
            font-size: 0.9rem;
            color: #666;
        }

        .task-actions {
            display: flex;
            gap: 5px;
        }

        /* Table Styles */
        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #e0e0e0;
        }

        th {
            background-color: #f8f9fa;
            font-weight: 600;
            color: var(--secondary);
        }

        tr:hover {
            background-color: #f8f9fa;
        }

        /* Form Styles */
        .form-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            color: var(--secondary);
        }

        input, select, textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 1rem;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--accent);
        }

        .btn {
            padding: 10px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 500;
            transition: all 0.3s;
        }

        .btn-primary {
            background-color: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background-color: #9a2840;
        }

        .btn-secondary {
            background-color: var(--secondary);
            color: white;
        }

        .btn-secondary:hover {
            background-color: #2d3649;
        }

        .btn-accent {
            background-color: var(--accent);
            color: white;
        }

        .btn-accent:hover {
            background-color: #ff946f;
        }

        .btn-success {
            background-color: var(--success);
            color: white;
        }

        .btn-warning {
            background-color: var(--warning);
            color: var(--dark);
        }

        .btn-danger {
            background-color: var(--danger);
            color: white;
        }

        .btn-sm {
            padding: 5px 10px;
            font-size: 0.875rem;
        }

        .action-buttons {
            display: flex;
            gap: 5px;
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1100;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background-color: white;
            border-radius: 8px;
            width: 90%;
            max-width: 600px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .modal-header {
            padding: 15px 20px;
            background-color: var(--secondary);
            color: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-body {
            padding: 20px;
            max-height: 70vh;
            overflow-y: auto;
        }

        .modal-footer {
            padding: 15px 20px;
            background-color: #f8f9fa;
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }

        .close {
            font-size: 1.5rem;
            cursor: pointer;
        }

        /* Tabs */
        .tabs {
            display: flex;
            border-bottom: 1px solid #ddd;
            margin-bottom: 20px;
        }

        .tab {
            padding: 10px 20px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
        }

        .tab.active {
            border-bottom: 3px solid var(--primary);
            color: var(--primary);
            font-weight: 500;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Attendance Status */
        .attendance-status {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.875rem;
            font-weight: 500;
        }

        .status-present {
            background-color: #d4edda;
            color: #155724;
        }

        .status-absent {
            background-color: #f8d7da;
            color: #721c24;
        }

        .status-late {
            background-color: #fff3cd;
            color: #856404;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .sidebar {
                width: 70px;
            }
            
            .sidebar-header h2, .sidebar-menu span {
                display: none;
            }
            
            .sidebar-menu a {
                justify-content: center;
                padding: 15px;
            }
            
            .sidebar-menu i {
                margin-right: 0;
            }
            
            .main-content {
                margin-left: 70px;
            }
        }

        /* Utility Classes */
        .d-flex {
            display: flex;
        }

        .justify-between {
            justify-content: space-between;
        }

        .align-center {
            align-items: center;
        }

        .text-center {
            text-align: center;
        }

        .mb-3 {
            margin-bottom: 1rem;
        }

        .mt-3 {
            margin-top: 1rem;
        }

        .p-3 {
            padding: 1rem;
        }

        .w-100 {
            width: 100%;
        }

        .hidden {
            display: none;
        }

        /* Student Dashboard Specific Styles */
        .attendance-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .attendance-card {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            padding: 20px;
            text-align: center;
            transition: transform 0.3s;
        }
        
        .attendance-card:hover {
            transform: translateY(-5px);
        }
        
        .attendance-card h3 {
            font-size: 2rem;
            color: var(--primary);
            margin-bottom: 10px;
        }
        
        .attendance-card p {
            color: var(--secondary);
            font-weight: 500;
        }
        
        .attendance-card .subject-name {
            font-size: 1.2rem;
            margin-bottom: 10px;
            color: var(--secondary);
        }
        
        .attendance-card .attendance-percentage {
            font-size: 1.5rem;
            font-weight: bold;
            margin: 10px 0;
        }
        
        .attendance-card .attendance-bar {
            height: 10px;
            background-color: #e0e0e0;
            border-radius: 5px;
            overflow: hidden;
            margin: 10px 0;
        }
        
        .attendance-card .attendance-progress {
            height: 100%;
            background-color: var(--primary);
        }
        
        .attendance-status-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }
        
        .status-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 5px;
        }
        
        .calendar-view {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 5px;
            margin-top: 15px;
        }
        
        .calendar-day {
            aspect-ratio: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: 500;
        }
        
        .calendar-day.present {
            background-color: #d4edda;
            color: #155724;
        }
        
        .calendar-day.absent {
            background-color: #f8d7da;
            color: #721c24;
        }
        
        .calendar-day.late {
            background-color: #fff3cd;
            color: #856404;
        }
        
        .calendar-day.no-class {
            background-color: #f8f9fa;
            color: #6c757d;
        }
    </style>
</head>
<body>
    <!-- Login Page -->
    <div id="login-page" class="login-container">
        <div class="login-left">
            <div class="login-logo">Edutrack</div>
            <div class="login-tagline">Comprehensive College Attendance Management System</div>
            <ul class="login-features">
                <li><i>✓</i> Easy student and teacher management</li>
                <li><i>✓</i> Comprehensive attendance tracking</li>
                <li><i>✓</i> Class and subject organization</li>
                <li><i>✓</i> Data backup and restore</li>
                <li><i>✓</i> Detailed analytics and reports</li>
            </ul>
        </div>
        <div class="login-right">
            <div class="login-form-container">
                <h1 class="login-title">Welcome to Edutrack</h1>
                <p class="login-subtitle">Please select your role and login</p>
                
                <div class="login-tabs">
                    <div class="login-tab active" data-tab="teacher">Teacher Login</div>
                    <div class="login-tab" data-tab="student">Student Login</div>
                </div>
                
                <form id="teacher-login-form" class="login-form active">
                    <div class="form-group">
                        <label for="teacher-username">Username</label>
                        <input type="text" id="teacher-username" placeholder="Enter your username" required>
                    </div>
                    <div class="form-group">
                        <label for="teacher-password">Password</label>
                        <input type="password" id="teacher-password" placeholder="Enter your password" required>
                    </div>
                    <button type="submit" class="btn btn-primary">Login as Teacher</button>
                    
                    <div class="demo-credentials">
                        <h4>Demo Credentials:</h4>
                        <p><strong>Username:</strong> teacher</p>
                        <p><strong>Password:</strong> password</p>
                    </div>
                </form>
                
                <form id="student-login-form" class="login-form">
                    <div class="form-group">
                        <label for="student-id">Student ID</label>
                        <input type="text" id="student-id" placeholder="Enter your student ID" required>
                    </div>
                    <div class="form-group">
                        <label for="student-password">Password</label>
                        <input type="password" id="student-password" placeholder="Enter your password" required>
                    </div>
                    <button type="submit" class="btn btn-primary">Login as Student</button>
                    
                    <div class="demo-credentials">
                        <h4>Demo Credentials:</h4>
                        <p><strong>Student ID:</strong> S001</p>
                        <p><strong>Password:</strong> password</p>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Teacher Dashboard -->
    <div id="dashboard-container" class="dashboard-container">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="sidebar-header">
                <h2>Edutrack</h2>
            </div>
            <div class="sidebar-menu">
                <ul>
                    <li><a href="#" class="active" data-section="dashboard"><i>📊</i> <span>Dashboard</span></a></li>
                    <li><a href="#" data-section="profile"><i>👤</i> <span>Profile</span></a></li>
                    <li><a href="#" data-section="students"><i>👨‍🎓</i> <span>Student Management</span></a></li>
                    <li><a href="#" data-section="attendance"><i>📝</i> <span>Attendance</span></a></li>
                    <li><a href="#" data-section="classes"><i>📚</i> <span>Classes & Subjects</span></a></li>
                    <li><a href="#" data-section="backup"><i>💾</i> <span>Backup & Restore</span></a></li>
                    <li><a href="#" data-section="settings"><i>⚙️</i> <span>Settings</span></a></li>
                    <li><a href="#" id="logout-btn"><i>🚪</i> <span>Logout</span></a></li>
                </ul>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <div class="header">
                <h1 id="page-title">Teacher Dashboard</h1>
                <div class="user-profile">
                    <div class="user-avatar" id="user-avatar">T</div>
                    <span id="user-name">Teacher</span>
                </div>
            </div>

            <!-- Dashboard Section -->
            <div id="dashboard" class="section active">
                <div class="stats-container">
                    <div class="stat-card">
                        <h3 id="total-students">0</h3>
                        <p>Total Students</p>
                    </div>
                    <div class="stat-card">
                        <h3 id="total-classes">0</h3>
                        <p>Total Classes</p>
                    </div>
                    <div class="stat-card">
                        <h3 id="attendance-rate">0%</h3>
                        <p>Overall Attendance Rate</p>
                    </div>
                    <div class="stat-card">
                        <h3 id="pending-tasks">0</h3>
                        <p>Pending Tasks</p>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3>Pending Tasks</h3>
                        <button class="btn btn-primary" id="view-all-tasks">View All</button>
                    </div>
                    <div class="card-body">
                        <div class="pending-tasks-list" id="pending-tasks-list">
                            <!-- Pending tasks will be populated here -->
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3>Recent Attendance Records</h3>
                        <button class="btn btn-primary" id="view-all-attendance">View All</button>
                    </div>
                    <div class="card-body">
                        <table id="recent-attendance-table">
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>Class</th>
                                    <th>Subject</th>
                                    <th>Present</th>
                                    <th>Absent</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Recent attendance records will be populated here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Profile Section -->
            <div id="profile" class="section hidden">
                <div class="card">
                    <div class="card-header">
                        <h3>Teacher Profile</h3>
                    </div>
                    <div class="card-body">
                        <form id="profile-form">
                            <div class="form-group">
                                <label for="teacher-name">Full Name</label>
                                <input type="text" id="teacher-name" required>
                            </div>
                            <div class="form-group">
                                <label for="teacher-email">Email</label>
                                <input type="email" id="teacher-email" required>
                            </div>
                            <div class="form-group">
                                <label for="teacher-department">Department</label>
                                <input type="text" id="teacher-department" required>
                            </div>
                            <div class="form-group">
                                <label for="teacher-phone">Phone</label>
                                <input type="tel" id="teacher-phone">
                            </div>
                            <button type="submit" class="btn btn-primary">Update Profile</button>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Student Management Section -->
            <div id="students" class="section hidden">
                <div class="card">
                    <div class="card-header">
                        <h3>Student Management</h3>
                        <button class="btn btn-primary" id="add-student-btn">Add Student</button>
                    </div>
                    <div class="card-body">
                        <table id="students-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Name</th>
                                    <th>Email</th>
                                    <th>Class</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Students will be populated here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Attendance Section -->
            <div id="attendance" class="section hidden">
                <div class="card">
                    <div class="card-header">
                        <h3>Attendance Management</h3>
                    </div>
                    <div class="card-body">
                        <div class="form-group">
                            <label for="attendance-class">Select Class</label>
                            <select id="attendance-class">
                                <option value="">-- Select Class --</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="attendance-subject">Select Subject</label>
                            <select id="attendance-subject">
                                <option value="">-- Select Subject --</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="attendance-date">Date</label>
                            <input type="date" id="attendance-date">
                        </div>
                        <button class="btn btn-primary" id="mark-attendance-btn">Mark Attendance</button>
                        
                        <div id="attendance-marking-section" class="hidden mt-3">
                            <h4>Mark Attendance for <span id="selected-class-subject"></span></h4>
                            <table id="attendance-marking-table">
                                <thead>
                                    <tr>
                                        <th>Student ID</th>
                                        <th>Name</th>
                                        <th>Status</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Students for attendance marking will be populated here -->
                                </tbody>
                            </table>
                            <button class="btn btn-success mt-3" id="save-attendance-btn">Save Attendance</button>
                        </div>
                    </div>
                </div>

                <div class="card mt-3">
                    <div class="card-header">
                        <h3>Attendance Records</h3>
                    </div>
                    <div class="card-body">
                        <div class="tabs">
                            <div class="tab active" data-tab="all-records">All Records</div>
                            <div class="tab" data-tab="by-student">By Student</div>
                            <div class="tab" data-tab="by-class">By Class</div>
                        </div>
                        
                        <div class="tab-content active" id="all-records">
                            <table id="attendance-records-table">
                                <thead>
                                    <tr>
                                        <th>Date</th>
                                        <th>Class</th>
                                        <th>Subject</th>
                                        <th>Present</th>
                                        <th>Absent</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Attendance records will be populated here -->
                                </tbody>
                            </table>
                        </div>
                        
                        <div class="tab-content" id="by-student">
                            <div class="form-group">
                                <label for="student-select">Select Student</label>
                                <select id="student-select">
                                    <option value="">-- Select Student --</option>
                                </select>
                            </div>
                            <table id="student-attendance-table" class="hidden">
                                <thead>
                                    <tr>
                                        <th>Date</th>
                                        <th>Class</th>
                                        <th>Subject</th>
                                        <th>Status</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Student-specific attendance records will be populated here -->
                                </tbody>
                            </table>
                        </div>
                        
                        <div class="tab-content" id="by-class">
                            <div class="form-group">
                                <label for="class-select">Select Class</label>
                                <select id="class-select">
                                    <option value="">-- Select Class --</option>
                                </select>
                            </div>
                            <table id="class-attendance-table" class="hidden">
                                <thead>
                                    <tr>
                                        <th>Date</th>
                                        <th>Subject</th>
                                        <th>Present</th>
                                        <th>Absent</th>
                                        <th>Attendance %</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Class-specific attendance records will be populated here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Classes & Subjects Section -->
            <div id="classes" class="section hidden">
                <div class="card">
                    <div class="card-header">
                        <h3>Classes & Subjects</h3>
                    </div>
                    <div class="card-body">
                        <div class="tabs">
                            <div class="tab active" data-tab="classes-tab">Classes</div>
                            <div class="tab" data-tab="subjects-tab">Subjects</div>
                        </div>
                        
                        <div class="tab-content active" id="classes-tab">
                            <div class="d-flex justify-between align-center mb-3">
                                <h4>Class List</h4>
                                <button class="btn btn-primary" id="add-class-btn">Add Class</button>
                            </div>
                            <table id="classes-table">
                                <thead>
                                    <tr>
                                        <th>Class ID</th>
                                        <th>Class Name</th>
                                        <th>Students</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Classes will be populated here -->
                                </tbody>
                            </table>
                        </div>
                        
                        <div class="tab-content" id="subjects-tab">
                            <div class="d-flex justify-between align-center mb-3">
                                <h4>Subject List</h4>
                                <button class="btn btn-primary" id="add-subject-btn">Add Subject</button>
                            </div>
                            <table id="subjects-table">
                                <thead>
                                    <tr>
                                        <th>Subject ID</th>
                                        <th>Subject Name</th>
                                        <th>Class</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Subjects will be populated here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Backup & Restore Section -->
            <div id="backup" class="section hidden">
                <div class="card">
                    <div class="card-header">
                        <h3>Backup & Restore</h3>
                    </div>
                    <div class="card-body">
                        <div class="form-group">
                            <h4>Export Data</h4>
                            <p>Download a backup of all your attendance data.</p>
                            <button class="btn btn-primary" id="export-data-btn">Export Data</button>
                        </div>
                        
                        <div class="form-group mt-3">
                            <h4>Import Data</h4>
                            <p>Restore your attendance data from a backup file.</p>
                            <input type="file" id="import-file" accept=".json">
                            <button class="btn btn-accent mt-2" id="import-data-btn">Import Data</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Settings Section -->
            <div id="settings" class="section hidden">
                <div class="card">
                    <div class="card-header">
                        <h3>System Settings</h3>
                    </div>
                    <div class="card-body">
                        <form id="settings-form">
                            <div class="form-group">
                                <label for="attendance-threshold">Attendance Threshold (%)</label>
                                <input type="number" id="attendance-threshold" min="0" max="100" value="75">
                                <small>The minimum attendance percentage required for students.</small>
                            </div>
                            <div class="form-group">
                                <label for="auto-logout">Auto Logout (minutes)</label>
                                <input type="number" id="auto-logout" min="1" value="30">
                                <small>Automatically log out after specified minutes of inactivity.</small>
                            </div>
                            <div class="form-group">
                                <label for="notifications">Enable Notifications</label>
                                <input type="checkbox" id="notifications" checked>
                            </div>
                            <button type="submit" class="btn btn-primary">Save Settings</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modals -->
        <!-- Add/Edit Student Modal -->
        <div id="student-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 id="student-modal-title">Add Student</h3>
                    <span class="close">&times;</span>
                </div>
                <div class="modal-body">
                    <form id="student-form">
                        <input type="hidden" id="student-id">
                        <div class="form-group">
                            <label for="student-name">Full Name</label>
                            <input type="text" id="student-name" required>
                        </div>
                        <div class="form-group">
                            <label for="student-email">Email</label>
                            <input type="email" id="student-email" required>
                        </div>
                        <div class="form-group">
                            <label for="student-class">Class</label>
                            <select id="student-class" required>
                                <option value="">-- Select Class --</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="student-phone">Phone</label>
                            <input type="tel" id="student-phone">
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" id="cancel-student-btn">Cancel</button>
                    <button class="btn btn-primary" id="save-student-btn">Save</button>
                </div>
            </div>
        </div>

        <!-- Add/Edit Class Modal -->
        <div id="class-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 id="class-modal-title">Add Class</h3>
                    <span class="close">&times;</span>
                </div>
                <div class="modal-body">
                    <form id="class-form">
                        <input type="hidden" id="class-id">
                        <div class="form-group">
                            <label for="class-name">Class Name</label>
                            <input type="text" id="class-name" required>
                        </div>
                        <div class="form-group">
                            <label for="class-description">Description</label>
                            <textarea id="class-description" rows="3"></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" id="cancel-class-btn">Cancel</button>
                    <button class="btn btn-primary" id="save-class-btn">Save</button>
                </div>
            </div>
        </div>

        <!-- Add/Edit Subject Modal -->
        <div id="subject-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 id="subject-modal-title">Add Subject</h3>
                    <span class="close">&times;</span>
                </div>
                <div class="modal-body">
                    <form id="subject-form">
                        <input type="hidden" id="subject-id">
                        <div class="form-group">
                            <label for="subject-name">Subject Name</label>
                            <input type="text" id="subject-name" required>
                        </div>
                        <div class="form-group">
                            <label for="subject-class">Class</label>
                            <select id="subject-class" required>
                                <option value="">-- Select Class --</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="subject-description">Description</label>
                            <textarea id="subject-description" rows="3"></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" id="cancel-subject-btn">Cancel</button>
                    <button class="btn btn-primary" id="save-subject-btn">Save</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Student Dashboard -->
    <div id="student-dashboard-container" class="dashboard-container" style="display: none;">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="sidebar-header">
                <h2>Edutrack</h2>
            </div>
            <div class="sidebar-menu">
                <ul>
                    <li><a href="#" class="active" data-section="student-dashboard"><i>📊</i> <span>Dashboard</span></a></li>
                    <li><a href="#" data-section="student-profile"><i>👤</i> <span>Profile</span></a></li>
                    <li><a href="#" data-section="student-attendance"><i>📝</i> <span>Attendance</span></a></li>
                    <li><a href="#" data-section="student-schedule"><i>📅</i> <span>Class Schedule</span></a></li>
                    <li><a href="#" data-section="student-settings"><i>⚙️</i> <span>Settings</span></a></li>
                    <li><a href="#" id="student-logout-btn"><i>🚪</i> <span>Logout</span></a></li>
                </ul>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <div class="header">
                <h1 id="student-page-title">Student Dashboard</h1>
                <div class="user-profile">
                    <div class="user-avatar" id="student-user-avatar">S</div>
                    <span id="student-user-name">Student</span>
                </div>
            </div>

            <!-- Student Dashboard Section -->
            <div id="student-dashboard" class="section active">
                <div class="stats-container">
                    <div class="stat-card">
                        <h3 id="student-total-subjects">0</h3>
                        <p>Total Subjects</p>
                    </div>
                    <div class="stat-card">
                        <h3 id="student-overall-attendance">0%</h3>
                        <p>Overall Attendance</p>
                    </div>
                    <div class="stat-card">
                        <h3 id="student-present-days">0</h3>
                        <p>Present Days</p>
                    </div>
                    <div class="stat-card">
                        <h3 id="student-absent-days">0</h3>
                        <p>Absent Days</p>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3>Attendance Summary by Subject</h3>
                    </div>
                    <div class="card-body">
                        <div class="attendance-summary" id="attendance-summary">
                            <!-- Attendance summary cards will be populated here -->
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3>Recent Attendance</h3>
                    </div>
                    <div class="card-body">
                        <table id="student-recent-attendance-table">
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>Subject</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Recent attendance records will be populated here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Student Profile Section -->
            <div id="student-profile" class="section hidden">
                <div class="card">
                    <div class="card-header">
                        <h3>Student Profile</h3>
                    </div>
                    <div class="card-body">
                        <form id="student-profile-form">
                            <div class="form-group">
                                <label for="student-profile-name">Full Name</label>
                                <input type="text" id="student-profile-name" readonly>
                            </div>
                            <div class="form-group">
                                <label for="student-profile-id">Student ID</label>
                                <input type="text" id="student-profile-id" readonly>
                            </div>
                            <div class="form-group">
                                <label for="student-profile-email">Email</label>
                                <input type="email" id="student-profile-email" readonly>
                            </div>
                            <div class="form-group">
                                <label for="student-profile-class">Class</label>
                                <input type="text" id="student-profile-class" readonly>
                            </div>
                            <div class="form-group">
                                <label for="student-profile-phone">Phone</label>
                                <input type="tel" id="student-profile-phone" readonly>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Student Attendance Section -->
            <div id="student-attendance" class="section hidden">
                <div class="card">
                    <div class="card-header">
                        <h3>Attendance Details</h3>
                    </div>
                    <div class="card-body">
                        <div class="tabs">
                            <div class="tab active" data-tab="student-all-attendance">All Records</div>
                            <div class="tab" data-tab="student-by-subject">By Subject</div>
                            <div class="tab" data-tab="student-calendar">Calendar View</div>
                        </div>
                        
                        <div class="tab-content active" id="student-all-attendance">
                            <table id="student-attendance-table">
                                <thead>
                                    <tr>
                                        <th>Date</th>
                                        <th>Subject</th>
                                        <th>Class</th>
                                        <th>Status</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- All attendance records will be populated here -->
                                </tbody>
                            </table>
                        </div>
                        
                        <div class="tab-content" id="student-by-subject">
                            <div class="form-group">
                                <label for="student-subject-select">Select Subject</label>
                                <select id="student-subject-select">
                                    <option value="">-- Select Subject --</option>
                                </select>
                            </div>
                            <div id="subject-attendance-details" class="hidden">
                                <h4>Attendance for <span id="selected-subject-name"></span></h4>
                                <div class="attendance-status-grid" id="subject-attendance-grid">
                                    <!-- Subject-specific attendance will be populated here -->
                                </div>
                                <div class="mt-3">
                                    <p><strong>Total Classes:</strong> <span id="subject-total-classes">0</span></p>
                                    <p><strong>Present:</strong> <span id="subject-present-count">0</span></p>
                                    <p><strong>Absent:</strong> <span id="subject-absent-count">0</span></p>
                                    <p><strong>Late:</strong> <span id="subject-late-count">0</span></p>
                                    <p><strong>Attendance Rate:</strong> <span id="subject-attendance-rate">0%</span></p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="tab-content" id="student-calendar">
                            <div class="form-group">
                                <label for="student-calendar-month">Select Month</label>
                                <select id="student-calendar-month">
                                    <option value="0">January</option>
                                    <option value="1">February</option>
                                    <option value="2">March</option>
                                    <option value="3">April</option>
                                    <option value="4">May</option>
                                    <option value="5">June</option>
                                    <option value="6">July</option>
                                    <option value="7">August</option>
                                    <option value="8">September</option>
                                    <option value="9">October</option>
                                    <option value="10">November</option>
                                    <option value="11">December</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="student-calendar-year">Select Year</label>
                                <select id="student-calendar-year">
                                    <!-- Year options will be populated dynamically -->
                                </select>
                            </div>
                            <div id="student-calendar-view" class="mt-3">
                                <!-- Calendar view will be populated here -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Student Schedule Section -->
            <div id="student-schedule" class="section hidden">
                <div class="card">
                    <div class="card-header">
                        <h3>Class Schedule</h3>
                    </div>
                    <div class="card-body">
                        <table id="student-schedule-table">
                            <thead>
                                <tr>
                                    <th>Subject</th>
                                    <th>Day</th>
                                    <th>Time</th>
                                    <th>Room</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Class schedule will be populated here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Student Settings Section -->
            <div id="student-settings" class="section hidden">
                <div class="card">
                    <div class="card-header">
                        <h3>Student Settings</h3>
                    </div>
                    <div class="card-body">
                        <form id="student-settings-form">
                            <div class="form-group">
                                <label for="student-notifications">Enable Notifications</label>
                                <input type="checkbox" id="student-notifications" checked>
                            </div>
                            <div class="form-group">
                                <label for="student-email-alerts">Email Alerts for Low Attendance</label>
                                <input type="checkbox" id="student-email-alerts" checked>
                            </div>
                            <div class="form-group">
                                <label for="student-theme">Theme Preference</label>
                                <select id="student-theme">
                                    <option value="light">Light</option>
                                    <option value="dark">Dark</option>
                                    <option value="auto">Auto (System)</option>
                                </select>
                            </div>
                            <button type="submit" class="btn btn-primary">Save Settings</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Login Page Functionality
        document.addEventListener('DOMContentLoaded', function() {
            // Check if user is already logged in
            const isLoggedIn = localStorage.getItem('edutrackLoggedIn');
            const userRole = localStorage.getItem('edutrackUserRole');
            
            if (isLoggedIn && userRole === 'teacher') {
                showDashboard();
            } else if (isLoggedIn && userRole === 'student') {
                showStudentDashboard();
            }
            
            // Login tabs functionality
            document.querySelectorAll('.login-tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabId = this.getAttribute('data-tab');
                    
                    // Update active tab
                    document.querySelectorAll('.login-tab').forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    
                    // Show corresponding form
                    document.querySelectorAll('.login-form').forEach(form => form.classList.remove('active'));
                    document.getElementById(`${tabId}-login-form`).classList.add('active');
                });
            });
            
            // Teacher login form
            document.getElementById('teacher-login-form').addEventListener('submit', function(e) {
                e.preventDefault();
                const username = document.getElementById('teacher-username').value;
                const password = document.getElementById('teacher-password').value;
                
                // Demo credentials check
                if (username === 'teacher' && password === 'password') {
                    localStorage.setItem('edutrackLoggedIn', 'true');
                    localStorage.setItem('edutrackUserRole', 'teacher');
                    showDashboard();
                } else {
                    alert('Invalid credentials. Use username: teacher, password: password');
                }
            });
            
            // Student login form
            document.getElementById('student-login-form').addEventListener('submit', function(e) {
                e.preventDefault();
                const studentId = document.getElementById('student-id').value;
                const password = document.getElementById('student-password').value;
                
                // Demo credentials check
                if (studentId === 'S001' && password === 'password') {
                    localStorage.setItem('edutrackLoggedIn', 'true');
                    localStorage.setItem('edutrackUserRole', 'student');
                    showStudentDashboard();
                } else {
                    alert('Invalid credentials. Use Student ID: S001, password: password');
                }
            });
        });
        
        function showDashboard() {
            document.getElementById('login-page').style.display = 'none';
            document.getElementById('dashboard-container').style.display = 'block';
            document.getElementById('student-dashboard-container').style.display = 'none';
            
            // Initialize the dashboard
            initDashboard();
        }
        
        function showStudentDashboard() {
            document.getElementById('login-page').style.display = 'none';
            document.getElementById('dashboard-container').style.display = 'none';
            document.getElementById('student-dashboard-container').style.display = 'block';
            
            // Initialize the student dashboard
            initStudentDashboard();
        }
        
        // Your existing dashboard JavaScript code starts here
        function initDashboard() {
            // Data Models
            let teacherData = {
                name: "John Doe",
                email: "john.doe@college.edu",
                department: "Computer Science",
                phone: "+1 234 567 8900"
            };

            let students = [];
            let classes = [];
            let subjects = [];
            let attendanceRecords = [];
            let settings = {
                attendanceThreshold: 75,
                autoLogout: 30,
                notifications: true
            };

            // DOM Elements
            const sections = document.querySelectorAll('.section');
            const sidebarLinks = document.querySelectorAll('.sidebar-menu a');
            const pageTitle = document.getElementById('page-title');
            const userAvatar = document.getElementById('user-avatar');
            const userName = document.getElementById('user-name');

            // Dashboard Elements
            const totalStudentsEl = document.getElementById('total-students');
            const totalClassesEl = document.getElementById('total-classes');
            const attendanceRateEl = document.getElementById('attendance-rate');
            const pendingTasksEl = document.getElementById('pending-tasks');
            const pendingTasksList = document.getElementById('pending-tasks-list');
            const recentAttendanceTable = document.getElementById('recent-attendance-table').querySelector('tbody');

            // Profile Elements
            const profileForm = document.getElementById('profile-form');
            const teacherNameInput = document.getElementById('teacher-name');
            const teacherEmailInput = document.getElementById('teacher-email');
            const teacherDepartmentInput = document.getElementById('teacher-department');
            const teacherPhoneInput = document.getElementById('teacher-phone');

            // Student Management Elements
            const studentsTable = document.getElementById('students-table').querySelector('tbody');
            const addStudentBtn = document.getElementById('add-student-btn');
            const studentModal = document.getElementById('student-modal');
            const studentForm = document.getElementById('student-form');
            const studentModalTitle = document.getElementById('student-modal-title');
            const saveStudentBtn = document.getElementById('save-student-btn');
            const cancelStudentBtn = document.getElementById('cancel-student-btn');

            // Attendance Elements
            const attendanceClassSelect = document.getElementById('attendance-class');
            const attendanceSubjectSelect = document.getElementById('attendance-subject');
            const attendanceDateInput = document.getElementById('attendance-date');
            const markAttendanceBtn = document.getElementById('mark-attendance-btn');
            const attendanceMarkingSection = document.getElementById('attendance-marking-section');
            const selectedClassSubject = document.getElementById('selected-class-subject');
            const attendanceMarkingTable = document.getElementById('attendance-marking-table').querySelector('tbody');
            const saveAttendanceBtn = document.getElementById('save-attendance-btn');
            const attendanceRecordsTable = document.getElementById('attendance-records-table').querySelector('tbody');
            const studentSelect = document.getElementById('student-select');
            const studentAttendanceTable = document.getElementById('student-attendance-table');
            const classSelect = document.getElementById('class-select');
            const classAttendanceTable = document.getElementById('class-attendance-table');

            // Classes & Subjects Elements
            const classesTable = document.getElementById('classes-table').querySelector('tbody');
            const addClassBtn = document.getElementById('add-class-btn');
            const classModal = document.getElementById('class-modal');
            const classForm = document.getElementById('class-form');
            const classModalTitle = document.getElementById('class-modal-title');
            const saveClassBtn = document.getElementById('save-class-btn');
            const cancelClassBtn = document.getElementById('cancel-class-btn');
            
            const subjectsTable = document.getElementById('subjects-table').querySelector('tbody');
            const addSubjectBtn = document.getElementById('add-subject-btn');
            const subjectModal = document.getElementById('subject-modal');
            const subjectForm = document.getElementById('subject-form');
            const subjectModalTitle = document.getElementById('subject-modal-title');
            const saveSubjectBtn = document.getElementById('save-subject-btn');
            const cancelSubjectBtn = document.getElementById('cancel-subject-btn');

            // Backup & Restore Elements
            const exportDataBtn = document.getElementById('export-data-btn');
            const importDataBtn = document.getElementById('import-data-btn');
            const importFileInput = document.getElementById('import-file');

            // Settings Elements
            const settingsForm = document.getElementById('settings-form');
            const attendanceThresholdInput = document.getElementById('attendance-threshold');
            const autoLogoutInput = document.getElementById('auto-logout');
            const notificationsInput = document.getElementById('notifications');

            // Initialize the application
            function init() {
                loadDataFromStorage();
                setupEventListeners();
                updateUI();
                showSection('dashboard');
                
                // Set current date for attendance
                attendanceDateInput.valueAsDate = new Date();
            }

            // Load data from localStorage
            function loadDataFromStorage() {
                const savedTeacherData = localStorage.getItem('teacherData');
                const savedStudents = localStorage.getItem('students');
                const savedClasses = localStorage.getItem('classes');
                const savedSubjects = localStorage.getItem('subjects');
                const savedAttendance = localStorage.getItem('attendanceRecords');
                const savedSettings = localStorage.getItem('settings');

                if (savedTeacherData) teacherData = JSON.parse(savedTeacherData);
                if (savedStudents) students = JSON.parse(savedStudents);
                if (savedClasses) classes = JSON.parse(savedClasses);
                if (savedSubjects) subjects = JSON.parse(savedSubjects);
                if (savedAttendance) attendanceRecords = JSON.parse(savedAttendance);
                if (savedSettings) settings = JSON.parse(savedSettings);

                // If no data exists, initialize with sample data
                if (students.length === 0) {
                    initializeSampleData();
                }
            }

            // Initialize with sample data for demonstration
            function initializeSampleData() {
                // Sample classes
                classes = [
                    { id: 'CS101', name: 'Computer Science 101', description: 'Introduction to Computer Science' },
                    { id: 'MATH201', name: 'Mathematics 201', description: 'Advanced Mathematics' },
                    { id: 'PHY301', name: 'Physics 301', description: 'Modern Physics' }
                ];

                // Sample subjects
                subjects = [
                    { id: 'CS101-PROG', name: 'Programming Fundamentals', classId: 'CS101', description: 'Introduction to programming concepts' },
                    { id: 'CS101-DB', name: 'Database Systems', classId: 'CS101', description: 'Introduction to database management' },
                    { id: 'MATH201-CALC', name: 'Calculus', classId: 'MATH201', description: 'Advanced calculus topics' },
                    { id: 'PHY301-QM', name: 'Quantum Mechanics', classId: 'PHY301', description: 'Principles of quantum mechanics' }
                ];

                // Sample students
                students = [
                    { id: 'S001', name: 'Alice Johnson', email: 'alice.johnson@student.college.edu', classId: 'CS101', phone: '123-456-7890' },
                    { id: 'S002', name: 'Bob Smith', email: 'bob.smith@student.college.edu', classId: 'CS101', phone: '123-456-7891' },
                    { id: 'S003', name: 'Carol Williams', email: 'carol.williams@student.college.edu', classId: 'MATH201', phone: '123-456-7892' },
                    { id: 'S004', name: 'David Brown', email: 'david.brown@student.college.edu', classId: 'MATH201', phone: '123-456-7893' },
                    { id: 'S005', name: 'Eva Davis', email: 'eva.davis@student.college.edu', classId: 'PHY301', phone: '123-456-7894' }
                ];

                // Sample attendance records
                const today = new Date();
                const yesterday = new Date(today);
                yesterday.setDate(yesterday.getDate() - 1);
                
                attendanceRecords = [
                    {
                        id: 'A001',
                        date: formatDate(yesterday),
                        classId: 'CS101',
                        subjectId: 'CS101-PROG',
                        records: [
                            { studentId: 'S001', status: 'present' },
                            { studentId: 'S002', status: 'absent' }
                        ]
                    },
                    {
                        id: 'A002',
                        date: formatDate(today),
                        classId: 'CS101',
                        subjectId: 'CS101-DB',
                        records: [
                            { studentId: 'S001', status: 'present' },
                            { studentId: 'S002', status: 'present' }
                        ]
                    }
                ];

                saveAllData();
            }

            // Save all data to localStorage
            function saveAllData() {
                localStorage.setItem('teacherData', JSON.stringify(teacherData));
                localStorage.setItem('students', JSON.stringify(students));
                localStorage.setItem('classes', JSON.stringify(classes));
                localStorage.setItem('subjects', JSON.stringify(subjects));
                localStorage.setItem('attendanceRecords', JSON.stringify(attendanceRecords));
                localStorage.setItem('settings', JSON.stringify(settings));
            }

            // Set up event listeners
            function setupEventListeners() {
                // Sidebar navigation
                sidebarLinks.forEach(link => {
                    link.addEventListener('click', (e) => {
                        e.preventDefault();
                        const section = link.getAttribute('data-section');
                        showSection(section);
                        
                        // Update active link
                        sidebarLinks.forEach(l => l.classList.remove('active'));
                        link.classList.add('active');
                    });
                });

                // Profile form
                profileForm.addEventListener('submit', (e) => {
                    e.preventDefault();
                    saveProfile();
                });

                // Student management
                addStudentBtn.addEventListener('click', () => openStudentModal());
                saveStudentBtn.addEventListener('click', saveStudent);
                cancelStudentBtn.addEventListener('click', () => closeModal(studentModal));

                // Attendance
                markAttendanceBtn.addEventListener('click', setupAttendanceMarking);
                saveAttendanceBtn.addEventListener('click', saveAttendance);
                
                // Class and subject selection for attendance
                attendanceClassSelect.addEventListener('change', updateSubjectOptions);
                
                // Tabs
                document.querySelectorAll('.tab').forEach(tab => {
                    tab.addEventListener('click', () => {
                        const tabId = tab.getAttribute('data-tab');
                        switchTab(tabId);
                    });
                });

                // Student attendance filter
                studentSelect.addEventListener('change', showStudentAttendance);
                
                // Class attendance filter
                classSelect.addEventListener('change', showClassAttendance);

                // Classes & Subjects
                addClassBtn.addEventListener('click', () => openClassModal());
                saveClassBtn.addEventListener('click', saveClass);
                cancelClassBtn.addEventListener('click', () => closeModal(classModal));
                
                addSubjectBtn.addEventListener('click', () => openSubjectModal());
                saveSubjectBtn.addEventListener('click', saveSubject);
                cancelSubjectBtn.addEventListener('click', () => closeModal(subjectModal));

                // Backup & Restore
                exportDataBtn.addEventListener('click', exportData);
                importDataBtn.addEventListener('click', importData);

                // Settings
                settingsForm.addEventListener('submit', (e) => {
                    e.preventDefault();
                    saveSettings();
                });

                // Modal close buttons
                document.querySelectorAll('.close').forEach(closeBtn => {
                    closeBtn.addEventListener('click', function() {
                        this.closest('.modal').style.display = 'none';
                    });
                });

                // Close modal when clicking outside
                window.addEventListener('click', (e) => {
                    if (e.target.classList.contains('modal')) {
                        e.target.style.display = 'none';
                    }
                });

                // View all tasks button
                document.getElementById('view-all-tasks').addEventListener('click', () => {
                    showSection('attendance');
                    document.querySelector('.sidebar-menu a[data-section="attendance"]').click();
                });

                // View all attendance button
                document.getElementById('view-all-attendance').addEventListener('click', () => {
                    showSection('attendance');
                    document.querySelector('.sidebar-menu a[data-section="attendance"]').click();
                });

                // Logout button
                document.getElementById('logout-btn').addEventListener('click', (e) => {
                    e.preventDefault();
                    localStorage.removeItem('edutrackLoggedIn');
                    localStorage.removeItem('edutrackUserRole');
                    location.reload();
                });
            }

            // Show/hide sections
            function showSection(sectionId) {
                sections.forEach(section => {
                    section.classList.add('hidden');
                    if (section.id === sectionId) {
                        section.classList.remove('hidden');
                        pageTitle.textContent = getSectionTitle(sectionId);
                        updateSectionContent(sectionId);
                    }
                });
            }

            // Get section title
            function getSectionTitle(sectionId) {
                const titles = {
                    'dashboard': 'Teacher Dashboard',
                    'profile': 'Teacher Profile',
                    'students': 'Student Management',
                    'attendance': 'Attendance Management',
                    'classes': 'Classes & Subjects',
                    'backup': 'Backup & Restore',
                    'settings': 'System Settings'
                };
                return titles[sectionId] || 'Teacher Dashboard';
            }

            // Update section-specific content
            function updateSectionContent(sectionId) {
                switch(sectionId) {
                    case 'dashboard':
                        updateDashboard();
                        break;
                    case 'profile':
                        updateProfile();
                        break;
                    case 'students':
                        updateStudentsTable();
                        break;
                    case 'attendance':
                        updateAttendanceSection();
                        break;
                    case 'classes':
                        updateClassesAndSubjects();
                        break;
                    case 'backup':
                        // Nothing specific to update
                        break;
                    case 'settings':
                        updateSettings();
                        break;
                }
            }

            // Update the entire UI
            function updateUI() {
                updateProfileDisplay();
                updateDashboard();
                updateStudentsTable();
                updateAttendanceSection();
                updateClassesAndSubjects();
            }

            // Update profile display in header
            function updateProfileDisplay() {
                userAvatar.textContent = teacherData.name.charAt(0);
                userName.textContent = teacherData.name;
            }

            // Update dashboard statistics and content
            function updateDashboard() {
                // Update stats
                totalStudentsEl.textContent = students.length;
                totalClassesEl.textContent = classes.length;
                
                // Calculate attendance rate
                let totalRecords = 0;
                let presentRecords = 0;
                
                attendanceRecords.forEach(record => {
                    record.records.forEach(studentRecord => {
                        totalRecords++;
                        if (studentRecord.status === 'present') presentRecords++;
                    });
                });
                
                const attendanceRate = totalRecords > 0 ? Math.round((presentRecords / totalRecords) * 100) : 0;
                attendanceRateEl.textContent = `${attendanceRate}%`;
                
                // Calculate pending tasks and update the list
                updatePendingTasks();
                
                // Update recent attendance table
                updateRecentAttendanceTable();
            }

            // Update pending tasks
            function updatePendingTasks() {
                const today = formatDate(new Date());
                
                // Find classes that don't have attendance marked for today
                const pendingClasses = classes.filter(classObj => {
                    const classStudents = students.filter(s => s.classId === classObj.id);
                    if (classStudents.length === 0) return false;
                    
                    // Check if attendance is marked for all subjects of this class today
                    const classSubjects = subjects.filter(s => s.classId === classObj.id);
                    const markedSubjects = attendanceRecords.filter(record => 
                        record.date === today && record.classId === classObj.id);
                    
                    return markedSubjects.length < classSubjects.length;
                });
                
                // Create task items
                pendingTasksList.innerHTML = '';
                let taskCount = 0;
                
                pendingClasses.forEach(classObj => {
                    const classSubjects = subjects.filter(s => s.classId === classObj.id);
                    const markedSubjects = attendanceRecords.filter(record => 
                        record.date === today && record.classId === classObj.id);
                    
                    const unmarkedSubjects = classSubjects.filter(subject => 
                        !markedSubjects.some(record => record.subjectId === subject.id));
                    
                    unmarkedSubjects.forEach(subject => {
                        const taskItem = document.createElement('div');
                        taskItem.className = 'task-item';
                        
                        taskItem.innerHTML = `
                            <div class="task-info">
                                <strong>Mark attendance for ${subject.name}</strong>
                                <span class="task-class">${classObj.name}</span>
                            </div>
                            <div class="task-actions">
                                <button class="btn btn-primary btn-sm mark-task-btn" data-class="${classObj.id}" data-subject="${subject.id}">Mark Now</button>
                            </div>
                        `;
                        
                        pendingTasksList.appendChild(taskItem);
                        taskCount++;
                    });
                });
                
                // Update task count
                pendingTasksEl.textContent = taskCount;
                
                // Add event listeners to mark task buttons
                document.querySelectorAll('.mark-task-btn').forEach(btn => {
                    btn.addEventListener('click', () => {
                        const classId = btn.getAttribute('data-class');
                        const subjectId = btn.getAttribute('data-subject');
                        
                        // Navigate to attendance section and pre-fill the form
                        showSection('attendance');
                        document.querySelector('.sidebar-menu a[data-section="attendance"]').classList.add('active');
                        
                        attendanceClassSelect.value = classId;
                        updateSubjectOptions();
                        attendanceSubjectSelect.value = subjectId;
                        attendanceDateInput.value = today;
                        
                        setupAttendanceMarking();
                    });
                });
                
                // If no pending tasks, show message
                if (taskCount === 0) {
                    pendingTasksList.innerHTML = '<p class="text-center">No pending tasks. All attendance is marked for today!</p>';
                }
            }

            // Update recent attendance table
            function updateRecentAttendanceTable() {
                recentAttendanceTable.innerHTML = '';
                
                // Show only the 5 most recent records
                const recentRecords = [...attendanceRecords]
                    .sort((a, b) => new Date(b.date) - new Date(a.date))
                    .slice(0, 5);
                
                recentRecords.forEach(record => {
                    const presentCount = record.records.filter(r => r.status === 'present').length;
                    const absentCount = record.records.filter(r => r.status === 'absent').length;
                    
                    const classObj = classes.find(c => c.id === record.classId);
                    const subjectObj = subjects.find(s => s.id === record.subjectId);
                    
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${formatDisplayDate(record.date)}</td>
                        <td>${classObj ? classObj.name : record.classId}</td>
                        <td>${subjectObj ? subjectObj.name : record.subjectId}</td>
                        <td>${presentCount}</td>
                        <td>${absentCount}</td>
                    `;
                    recentAttendanceTable.appendChild(row);
                });
            }

            // Update profile form with current data
            function updateProfile() {
                teacherNameInput.value = teacherData.name;
                teacherEmailInput.value = teacherData.email;
                teacherDepartmentInput.value = teacherData.department;
                teacherPhoneInput.value = teacherData.phone;
            }

            // Save profile data
            function saveProfile() {
                teacherData.name = teacherNameInput.value;
                teacherData.email = teacherEmailInput.value;
                teacherData.department = teacherDepartmentInput.value;
                teacherData.phone = teacherPhoneInput.value;
                
                saveAllData();
                updateProfileDisplay();
                alert('Profile updated successfully!');
            }

            // Update students table
            function updateStudentsTable() {
                studentsTable.innerHTML = '';
                
                students.forEach(student => {
                    const classObj = classes.find(c => c.id === student.classId);
                    
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${student.id}</td>
                        <td>${student.name}</td>
                        <td>${student.email}</td>
                        <td>${classObj ? classObj.name : student.classId}</td>
                        <td class="action-buttons">
                            <button class="btn btn-warning btn-sm edit-student" data-id="${student.id}">Edit</button>
                            <button class="btn btn-danger btn-sm delete-student" data-id="${student.id}">Delete</button>
                        </td>
                    `;
                    studentsTable.appendChild(row);
                });
                
                // Add event listeners to edit and delete buttons
                document.querySelectorAll('.edit-student').forEach(btn => {
                    btn.addEventListener('click', () => {
                        const studentId = btn.getAttribute('data-id');
                        openStudentModal(studentId);
                    });
                });
                
                document.querySelectorAll('.delete-student').forEach(btn => {
                    btn.addEventListener('click', () => {
                        const studentId = btn.getAttribute('data-id');
                        deleteStudent(studentId);
                    });
                });
            }

            // Open student modal for adding or editing
            function openStudentModal(studentId = null) {
                // Reset form
                studentForm.reset();
                document.getElementById('student-id').value = '';
                
                // Populate class options
                const studentClassSelect = document.getElementById('student-class');
                studentClassSelect.innerHTML = '<option value="">-- Select Class --</option>';
                classes.forEach(classObj => {
                    const option = document.createElement('option');
                    option.value = classObj.id;
                    option.textContent = classObj.name;
                    studentClassSelect.appendChild(option);
                });
                
                if (studentId) {
                    // Edit mode
                    const student = students.find(s => s.id === studentId);
                    if (student) {
                        studentModalTitle.textContent = 'Edit Student';
                        document.getElementById('student-id').value = student.id;
                        document.getElementById('student-name').value = student.name;
                        document.getElementById('student-email').value = student.email;
                        document.getElementById('student-class').value = student.classId;
                        document.getElementById('student-phone').value = student.phone || '';
                    }
                } else {
                    // Add mode
                    studentModalTitle.textContent = 'Add Student';
                }
                
                studentModal.style.display = 'flex';
            }

            // Save student (add or update)
            function saveStudent() {
                const studentId = document.getElementById('student-id').value;
                const name = document.getElementById('student-name').value;
                const email = document.getElementById('student-email').value;
                const classId = document.getElementById('student-class').value;
                const phone = document.getElementById('student-phone').value;
                
                if (!name || !email || !classId) {
                    alert('Please fill in all required fields');
                    return;
                }
                
                if (studentId) {
                    // Update existing student
                    const index = students.findIndex(s => s.id === studentId);
                    if (index !== -1) {
                        students[index] = { ...students[index], name, email, classId, phone };
                    }
                } else {
                    // Add new student
                    const newId = 'S' + String(students.length + 1).padStart(3, '0');
                    students.push({
                        id: newId,
                        name,
                        email,
                        classId,
                        phone
                    });
                }
                
                saveAllData();
                updateStudentsTable();
                updateDashboard();
                closeModal(studentModal);
            }

            // Delete student
            function deleteStudent(studentId) {
                if (confirm('Are you sure you want to delete this student?')) {
                    students = students.filter(s => s.id !== studentId);
                    
                    // Also remove attendance records for this student
                    attendanceRecords.forEach(record => {
                        record.records = record.records.filter(r => r.studentId !== studentId);
                    });
                    
                    saveAllData();
                    updateStudentsTable();
                    updateDashboard();
                    updateAttendanceSection();
                }
            }

            // Update attendance section
            function updateAttendanceSection() {
                // Update class and subject selects
                updateClassSelect(attendanceClassSelect);
                updateClassSelect(document.getElementById('student-class'));
                updateClassSelect(classSelect);
                
                // Update student select
                updateStudentSelect();
                
                // Update attendance records table
                updateAttendanceRecordsTable();
            }

            // Update class select options
            function updateClassSelect(selectElement) {
                const currentValue = selectElement.value;
                selectElement.innerHTML = '<option value="">-- Select Class --</option>';
                
                classes.forEach(classObj => {
                    const option = document.createElement('option');
                    option.value = classObj.id;
                    option.textContent = classObj.name;
                    selectElement.appendChild(option);
                });
                
                // Restore previous value if it still exists
                if (currentValue && classes.some(c => c.id === currentValue)) {
                    selectElement.value = currentValue;
                }
            }

            // Update subject options based on selected class
            function updateSubjectOptions() {
                const classId = attendanceClassSelect.value;
                attendanceSubjectSelect.innerHTML = '<option value="">-- Select Subject --</option>';
                
                if (classId) {
                    const classSubjects = subjects.filter(s => s.classId === classId);
                    classSubjects.forEach(subject => {
                        const option = document.createElement('option');
                        option.value = subject.id;
                        option.textContent = subject.name;
                        attendanceSubjectSelect.appendChild(option);
                    });
                }
            }

            // Update student select options
            function updateStudentSelect() {
                studentSelect.innerHTML = '<option value="">-- Select Student --</option>';
                
                students.forEach(student => {
                    const option = document.createElement('option');
                    option.value = student.id;
                    option.textContent = `${student.name} (${student.id})`;
                    studentSelect.appendChild(option);
                });
            }

            // Setup attendance marking interface
            function setupAttendanceMarking() {
                const classId = attendanceClassSelect.value;
                const subjectId = attendanceSubjectSelect.value;
                const date = attendanceDateInput.value;
                
                if (!classId || !subjectId || !date) {
                    alert('Please select class, subject, and date');
                    return;
                }
                
                const classObj = classes.find(c => c.id === classId);
                const subjectObj = subjects.find(s => s.id === subjectId);
                
                selectedClassSubject.textContent = `${classObj.name} - ${subjectObj.name} (${formatDisplayDate(date)})`;
                
                // Get students in the selected class
                const classStudents = students.filter(s => s.classId === classId);
                
                // Check if attendance already exists for this date, class, and subject
                const existingRecord = attendanceRecords.find(record => 
                    record.date === date && record.classId === classId && record.subjectId === subjectId);
                
                // Populate attendance marking table
                attendanceMarkingTable.innerHTML = '';
                
                classStudents.forEach(student => {
                    const existingStatus = existingRecord ? 
                        existingRecord.records.find(r => r.studentId === student.id)?.status : 'present';
                    
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${student.id}</td>
                        <td>${student.name}</td>
                        <td>
                            <select class="attendance-status" data-student="${student.id}">
                                <option value="present" ${existingStatus === 'present' ? 'selected' : ''}>Present</option>
                                <option value="absent" ${existingStatus === 'absent' ? 'selected' : ''}>Absent</option>
                                <option value="late" ${existingStatus === 'late' ? 'selected' : ''}>Late</option>
                            </select>
                        </td>
                    `;
                    attendanceMarkingTable.appendChild(row);
                });
                
                attendanceMarkingSection.classList.remove('hidden');
            }

            // Save attendance records
            function saveAttendance() {
                const classId = attendanceClassSelect.value;
                const subjectId = attendanceSubjectSelect.value;
                const date = attendanceDateInput.value;
                
                if (!classId || !subjectId || !date) {
                    alert('Please select class, subject, and date');
                    return;
                }
                
                // Get all attendance statuses
                const statusSelects = document.querySelectorAll('.attendance-status');
                const records = [];
                
                statusSelects.forEach(select => {
                    const studentId = select.getAttribute('data-student');
                    const status = select.value;
                    records.push({ studentId, status });
                });
                
                // Check if record already exists
                const existingIndex = attendanceRecords.findIndex(record => 
                    record.date === date && record.classId === classId && record.subjectId === subjectId);
                
                if (existingIndex !== -1) {
                    // Update existing record
                    attendanceRecords[existingIndex].records = records;
                } else {
                    // Create new record
                    const newId = 'A' + String(attendanceRecords.length + 1).padStart(3, '0');
                    attendanceRecords.push({
                        id: newId,
                        date,
                        classId,
                        subjectId,
                        records
                    });
                }
                
                saveAllData();
                updateDashboard();
                updateAttendanceRecordsTable();
                alert('Attendance saved successfully!');
                
                // Reset form
                attendanceMarkingSection.classList.add('hidden');
                attendanceClassSelect.value = '';
                attendanceSubjectSelect.value = '';
            }

            // Update attendance records table
            function updateAttendanceRecordsTable() {
                attendanceRecordsTable.innerHTML = '';
                
                attendanceRecords.forEach(record => {
                    const presentCount = record.records.filter(r => r.status === 'present').length;
                    const absentCount = record.records.filter(r => r.status === 'absent').length;
                    const lateCount = record.records.filter(r => r.status === 'late').length;
                    
                    const classObj = classes.find(c => c.id === record.classId);
                    const subjectObj = subjects.find(s => s.id === record.subjectId);
                    
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${formatDisplayDate(record.date)}</td>
                        <td>${classObj ? classObj.name : record.classId}</td>
                        <td>${subjectObj ? subjectObj.name : record.subjectId}</td>
                        <td>${presentCount}</td>
                        <td>${absentCount + lateCount}</td>
                        <td class="action-buttons">
                            <button class="btn btn-warning btn-sm edit-attendance" data-id="${record.id}">Edit</button>
                            <button class="btn btn-danger btn-sm delete-attendance" data-id="${record.id}">Delete</button>
                        </td>
                    `;
                    attendanceRecordsTable.appendChild(row);
                });
                
                // Add event listeners to edit and delete buttons
                document.querySelectorAll('.edit-attendance').forEach(btn => {
                    btn.addEventListener('click', () => {
                        const recordId = btn.getAttribute('data-id');
                        editAttendance(recordId);
                    });
                });
                
                document.querySelectorAll('.delete-attendance').forEach(btn => {
                    btn.addEventListener('click', () => {
                        const recordId = btn.getAttribute('data-id');
                        deleteAttendance(recordId);
                    });
                });
            }

            // Edit attendance record
            function editAttendance(recordId) {
                const record = attendanceRecords.find(r => r.id === recordId);
                if (record) {
                    attendanceClassSelect.value = record.classId;
                    updateSubjectOptions();
                    attendanceSubjectSelect.value = record.subjectId;
                    attendanceDateInput.value = record.date;
                    
                    setupAttendanceMarking();
                }
            }

            // Delete attendance record
            function deleteAttendance(recordId) {
                if (confirm('Are you sure you want to delete this attendance record?')) {
                    attendanceRecords = attendanceRecords.filter(r => r.id !== recordId);
                    saveAllData();
                    updateDashboard();
                    updateAttendanceRecordsTable();
                }
            }

            // Switch between tabs
            function switchTab(tabId) {
                // Update active tab
                document.querySelectorAll('.tab').forEach(tab => {
                    tab.classList.remove('active');
                    if (tab.getAttribute('data-tab') === tabId) {
                        tab.classList.add('active');
                    }
                });
                
                // Update active tab content
                document.querySelectorAll('.tab-content').forEach(content => {
                    content.classList.remove('active');
                    if (content.id === tabId) {
                        content.classList.add('active');
                    }
                });
            }

            // Show student-specific attendance
            function showStudentAttendance() {
                const studentId = studentSelect.value;
                
                if (!studentId) {
                    studentAttendanceTable.classList.add('hidden');
                    return;
                }
                
                const student = students.find(s => s.id === studentId);
                if (!student) return;
                
                const studentRecords = attendanceRecords.filter(record => 
                    record.records.some(r => r.studentId === studentId));
                
                const tableBody = studentAttendanceTable.querySelector('tbody');
                tableBody.innerHTML = '';
                
                studentRecords.forEach(record => {
                    const studentRecord = record.records.find(r => r.studentId === studentId);
                    const classObj = classes.find(c => c.id === record.classId);
                    const subjectObj = subjects.find(s => s.id === record.subjectId);
                    
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${formatDisplayDate(record.date)}</td>
                        <td>${classObj ? classObj.name : record.classId}</td>
                        <td>${subjectObj ? subjectObj.name : record.subjectId}</td>
                        <td><span class="attendance-status status-${studentRecord.status}">${studentRecord.status.charAt(0).toUpperCase() + studentRecord.status.slice(1)}</span></td>
                    `;
                    tableBody.appendChild(row);
                });
                
                studentAttendanceTable.classList.remove('hidden');
            }

            // Show class-specific attendance
            function showClassAttendance() {
                const classId = classSelect.value;
                
                if (!classId) {
                    classAttendanceTable.classList.add('hidden');
                    return;
                }
                
                const classRecords = attendanceRecords.filter(record => record.classId === classId);
                
                const tableBody = classAttendanceTable.querySelector('tbody');
                tableBody.innerHTML = '';
                
                classRecords.forEach(record => {
                    const presentCount = record.records.filter(r => r.status === 'present').length;
                    const totalCount = record.records.length;
                    const attendancePercentage = totalCount > 0 ? Math.round((presentCount / totalCount) * 100) : 0;
                    
                    const subjectObj = subjects.find(s => s.id === record.subjectId);
                    
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${formatDisplayDate(record.date)}</td>
                        <td>${subjectObj ? subjectObj.name : record.subjectId}</td>
                        <td>${presentCount}</td>
                        <td>${totalCount - presentCount}</td>
                        <td>${attendancePercentage}%</td>
                    `;
                    tableBody.appendChild(row);
                });
                
                classAttendanceTable.classList.remove('hidden');
            }

            // Update classes and subjects section
            function updateClassesAndSubjects() {
                updateClassesTable();
                updateSubjectsTable();
            }

            // Update classes table
            function updateClassesTable() {
                classesTable.innerHTML = '';
                
                classes.forEach(classObj => {
                    const studentCount = students.filter(s => s.classId === classObj.id).length;
                    
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${classObj.id}</td>
                        <td>${classObj.name}</td>
                        <td>${studentCount}</td>
                        <td class="action-buttons">
                            <button class="btn btn-warning btn-sm edit-class" data-id="${classObj.id}">Edit</button>
                            <button class="btn btn-danger btn-sm delete-class" data-id="${classObj.id}">Delete</button>
                        </td>
                    `;
                    classesTable.appendChild(row);
                });
                
                // Add event listeners to edit and delete buttons
                document.querySelectorAll('.edit-class').forEach(btn => {
                    btn.addEventListener('click', () => {
                        const classId = btn.getAttribute('data-id');
                        openClassModal(classId);
                    });
                });
                
                document.querySelectorAll('.delete-class').forEach(btn => {
                    btn.addEventListener('click', () => {
                        const classId = btn.getAttribute('data-id');
                        deleteClass(classId);
                    });
                });
            }

            // Open class modal for adding or editing
            function openClassModal(classId = null) {
                // Reset form
                classForm.reset();
                document.getElementById('class-id').value = '';
                
                if (classId) {
                    // Edit mode
                    const classObj = classes.find(c => c.id === classId);
                    if (classObj) {
                        classModalTitle.textContent = 'Edit Class';
                        document.getElementById('class-id').value = classObj.id;
                        document.getElementById('class-name').value = classObj.name;
                        document.getElementById('class-description').value = classObj.description || '';
                    }
                } else {
                    // Add mode
                    classModalTitle.textContent = 'Add Class';
                }
                
                classModal.style.display = 'flex';
            }

            // Save class (add or update)
            function saveClass() {
                const classId = document.getElementById('class-id').value;
                const name = document.getElementById('class-name').value;
                const description = document.getElementById('class-description').value;
                
                if (!name) {
                    alert('Please enter a class name');
                    return;
                }
                
                if (classId) {
                    // Update existing class
                    const index = classes.findIndex(c => c.id === classId);
                    if (index !== -1) {
                        classes[index] = { ...classes[index], name, description };
                    }
                } else {
                    // Add new class
                    const newId = name.replace(/\s+/g, '').toUpperCase().substring(0, 10);
                    classes.push({
                        id: newId,
                        name,
                        description
                    });
                }
                
                saveAllData();
                updateClassesTable();
                updateDashboard();
                updateAttendanceSection();
                closeModal(classModal);
            }

            // Delete class
            function deleteClass(classId) {
                // Check if there are students in this class
                const studentsInClass = students.filter(s => s.classId === classId);
                if (studentsInClass.length > 0) {
                    alert('Cannot delete class with students. Please reassign or delete the students first.');
                    return;
                }
                
                // Check if there are subjects for this class
                const subjectsInClass = subjects.filter(s => s.classId === classId);
                if (subjectsInClass.length > 0) {
                    alert('Cannot delete class with subjects. Please delete the subjects first.');
                    return;
                }
                
                if (confirm('Are you sure you want to delete this class?')) {
                    classes = classes.filter(c => c.id !== classId);
                    saveAllData();
                    updateClassesTable();
                    updateDashboard();
                    updateAttendanceSection();
                }
            }

            // Update subjects table
            function updateSubjectsTable() {
                subjectsTable.innerHTML = '';
                
                subjects.forEach(subject => {
                    const classObj = classes.find(c => c.id === subject.classId);
                    
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${subject.id}</td>
                        <td>${subject.name}</td>
                        <td>${classObj ? classObj.name : subject.classId}</td>
                        <td class="action-buttons">
                            <button class="btn btn-warning btn-sm edit-subject" data-id="${subject.id}">Edit</button>
                            <button class="btn btn-danger btn-sm delete-subject" data-id="${subject.id}">Delete</button>
                        </td>
                    `;
                    subjectsTable.appendChild(row);
                });
                
                // Add event listeners to edit and delete buttons
                document.querySelectorAll('.edit-subject').forEach(btn => {
                    btn.addEventListener('click', () => {
                        const subjectId = btn.getAttribute('data-id');
                        openSubjectModal(subjectId);
                    });
                });
                
                document.querySelectorAll('.delete-subject').forEach(btn => {
                    btn.addEventListener('click', () => {
                        const subjectId = btn.getAttribute('data-id');
                        deleteSubject(subjectId);
                    });
                });
            }

            // Open subject modal for adding or editing
            function openSubjectModal(subjectId = null) {
                // Reset form
                subjectForm.reset();
                document.getElementById('subject-id').value = '';
                
                // Populate class options
                const subjectClassSelect = document.getElementById('subject-class');
                subjectClassSelect.innerHTML = '<option value="">-- Select Class --</option>';
                classes.forEach(classObj => {
                    const option = document.createElement('option');
                    option.value = classObj.id;
                    option.textContent = classObj.name;
                    subjectClassSelect.appendChild(option);
                });
                
                if (subjectId) {
                    // Edit mode
                    const subject = subjects.find(s => s.id === subjectId);
                    if (subject) {
                        subjectModalTitle.textContent = 'Edit Subject';
                        document.getElementById('subject-id').value = subject.id;
                        document.getElementById('subject-name').value = subject.name;
                        document.getElementById('subject-class').value = subject.classId;
                        document.getElementById('subject-description').value = subject.description || '';
                    }
                } else {
                    // Add mode
                    subjectModalTitle.textContent = 'Add Subject';
                }
                
                subjectModal.style.display = 'flex';
            }

            // Save subject (add or update)
            function saveSubject() {
                const subjectId = document.getElementById('subject-id').value;
                const name = document.getElementById('subject-name').value;
                const classId = document.getElementById('subject-class').value;
                const description = document.getElementById('subject-description').value;
                
                if (!name || !classId) {
                    alert('Please fill in all required fields');
                    return;
                }
                
                if (subjectId) {
                    // Update existing subject
                    const index = subjects.findIndex(s => s.id === subjectId);
                    if (index !== -1) {
                        subjects[index] = { ...subjects[index], name, classId, description };
                    }
                } else {
                    // Add new subject
                    const newId = classId + '-' + name.replace(/\s+/g, '').toUpperCase().substring(0, 4);
                    subjects.push({
                        id: newId,
                        name,
                        classId,
                        description
                    });
                }
                
                saveAllData();
                updateSubjectsTable();
                updateAttendanceSection();
                closeModal(subjectModal);
            }

            // Delete subject
            function deleteSubject(subjectId) {
                // Check if there are attendance records for this subject
                const recordsForSubject = attendanceRecords.filter(r => r.subjectId === subjectId);
                if (recordsForSubject.length > 0) {
                    alert('Cannot delete subject with attendance records. Please delete the records first.');
                    return;
                }
                
                if (confirm('Are you sure you want to delete this subject?')) {
                    subjects = subjects.filter(s => s.id !== subjectId);
                    saveAllData();
                    updateSubjectsTable();
                    updateAttendanceSection();
                }
            }

            // Export data
            function exportData() {
                const data = {
                    teacherData,
                    students,
                    classes,
                    subjects,
                    attendanceRecords,
                    settings,
                    exportDate: new Date().toISOString()
                };
                
                const dataStr = JSON.stringify(data, null, 2);
                const dataBlob = new Blob([dataStr], { type: 'application/json' });
                
                const url = URL.createObjectURL(dataBlob);
                const link = document.createElement('a');
                link.href = url;
                link.download = `edutrack_backup_${formatDate(new Date())}.json`;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                URL.revokeObjectURL(url);
                
                alert('Data exported successfully!');
            }

            // Import data
            function importData() {
                const file = importFileInput.files[0];
                if (!file) {
                    alert('Please select a file to import');
                    return;
                }
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const data = JSON.parse(e.target.result);
                        
                        // Validate the data structure
                        if (!data.students || !data.classes || !data.subjects || !data.attendanceRecords) {
                            throw new Error('Invalid data format');
                        }
                        
                        if (confirm('This will replace all your current data. Are you sure?')) {
                            teacherData = data.teacherData || teacherData;
                            students = data.students;
                            classes = data.classes;
                            subjects = data.subjects;
                            attendanceRecords = data.attendanceRecords;
                            settings = data.settings || settings;
                            
                            saveAllData();
                            updateUI();
                            alert('Data imported successfully!');
                        }
                    } catch (error) {
                        alert('Error importing data: ' + error.message);
                    }
                };
                reader.readAsText(file);
            }

            // Update settings form
            function updateSettings() {
                attendanceThresholdInput.value = settings.attendanceThreshold;
                autoLogoutInput.value = settings.autoLogout;
                notificationsInput.checked = settings.notifications;
            }

            // Save settings
            function saveSettings() {
                settings.attendanceThreshold = parseInt(attendanceThresholdInput.value);
                settings.autoLogout = parseInt(autoLogoutInput.value);
                settings.notifications = notificationsInput.checked;
                
                saveAllData();
                alert('Settings saved successfully!');
            }

            // Close modal
            function closeModal(modal) {
                modal.style.display = 'none';
            }

            // Utility function to format date as YYYY-MM-DD
            function formatDate(date) {
                return date.toISOString().split('T')[0];
            }

            // Utility function to format date for display
            function formatDisplayDate(dateString) {
                const options = { year: 'numeric', month: 'short', day: 'numeric' };
                return new Date(dateString).toLocaleDateString(undefined, options);
            }

            // Initialize the dashboard
            init();
        }

        // Student Dashboard Functionality
        function initStudentDashboard() {
            // Data Models
            let studentData = {
                id: "S001",
                name: "Alice Johnson",
                email: "alice.johnson@student.college.edu",
                classId: "CS101",
                phone: "123-456-7890"
            };

            let studentSettings = {
                notifications: true,
                emailAlerts: true,
                theme: "light"
            };

            // DOM Elements
            const studentSections = document.querySelectorAll('#student-dashboard-container .section');
            const studentSidebarLinks = document.querySelectorAll('#student-dashboard-container .sidebar-menu a');
            const studentPageTitle = document.getElementById('student-page-title');
            const studentUserAvatar = document.getElementById('student-user-avatar');
            const studentUserName = document.getElementById('student-user-name');

            // Dashboard Elements
            const studentTotalSubjectsEl = document.getElementById('student-total-subjects');
            const studentOverallAttendanceEl = document.getElementById('student-overall-attendance');
            const studentPresentDaysEl = document.getElementById('student-present-days');
            const studentAbsentDaysEl = document.getElementById('student-absent-days');
            const attendanceSummary = document.getElementById('attendance-summary');
            const studentRecentAttendanceTable = document.getElementById('student-recent-attendance-table').querySelector('tbody');

            // Profile Elements
            const studentProfileForm = document.getElementById('student-profile-form');
            const studentProfileNameInput = document.getElementById('student-profile-name');
            const studentProfileIdInput = document.getElementById('student-profile-id');
            const studentProfileEmailInput = document.getElementById('student-profile-email');
            const studentProfileClassInput = document.getElementById('student-profile-class');
            const studentProfilePhoneInput = document.getElementById('student-profile-phone');

            // Attendance Elements
            const studentAttendanceTable = document.getElementById('student-attendance-table').querySelector('tbody');
            const studentSubjectSelect = document.getElementById('student-subject-select');
            const subjectAttendanceDetails = document.getElementById('subject-attendance-details');
            const selectedSubjectName = document.getElementById('selected-subject-name');
            const subjectAttendanceGrid = document.getElementById('subject-attendance-grid');
            const subjectTotalClasses = document.getElementById('subject-total-classes');
            const subjectPresentCount = document.getElementById('subject-present-count');
            const subjectAbsentCount = document.getElementById('subject-absent-count');
            const subjectLateCount = document.getElementById('subject-late-count');
            const subjectAttendanceRate = document.getElementById('subject-attendance-rate');
            
            // Calendar Elements
            const studentCalendarMonth = document.getElementById('student-calendar-month');
            const studentCalendarYear = document.getElementById('student-calendar-year');
            const studentCalendarView = document.getElementById('student-calendar-view');

            // Schedule Elements
            const studentScheduleTable = document.getElementById('student-schedule-table').querySelector('tbody');

            // Settings Elements
            const studentSettingsForm = document.getElementById('student-settings-form');
            const studentNotificationsInput = document.getElementById('student-notifications');
            const studentEmailAlertsInput = document.getElementById('student-email-alerts');
            const studentThemeInput = document.getElementById('student-theme');

            // Initialize the student dashboard
            function init() {
                loadStudentData();
                setupStudentEventListeners();
                updateStudentUI();
                showStudentSection('student-dashboard');
                
                // Set current month and year for calendar
                const now = new Date();
                studentCalendarMonth.value = now.getMonth();
                populateYearOptions();
                studentCalendarYear.value = now.getFullYear();
                
                // Apply saved theme
                applyTheme();
            }

            // Load student data from localStorage
            function loadStudentData() {
                const savedStudentData = localStorage.getItem('studentData');
                const savedStudentSettings = localStorage.getItem('studentSettings');

                if (savedStudentData) studentData = JSON.parse(savedStudentData);
                if (savedStudentSettings) studentSettings = JSON.parse(savedStudentSettings);

                // If no student data exists, use the demo student data
                if (!savedStudentData) {
                    // Try to get student data from teacher's data
                    const savedStudents = localStorage.getItem('students');
                    if (savedStudents) {
                        const students = JSON.parse(savedStudents);
                        const demoStudent = students.find(s => s.id === 'S001');
                        if (demoStudent) {
                            studentData = demoStudent;
                        }
                    }
                }
            }

            // Set up event listeners for student dashboard
            function setupStudentEventListeners() {
                // Sidebar navigation
                studentSidebarLinks.forEach(link => {
                    link.addEventListener('click', (e) => {
                        e.preventDefault();
                        const section = link.getAttribute('data-section');
                        showStudentSection(section);
                        
                        // Update active link
                        studentSidebarLinks.forEach(l => l.classList.remove('active'));
                        link.classList.add('active');
                    });
                });

                // Attendance tabs
                document.querySelectorAll('#student-attendance .tab').forEach(tab => {
                    tab.addEventListener('click', () => {
                        const tabId = tab.getAttribute('data-tab');
                        switchStudentTab(tabId);
                    });
                });

                // Subject selection for attendance details
                studentSubjectSelect.addEventListener('change', showSubjectAttendanceDetails);
                
                // Calendar month/year changes
                studentCalendarMonth.addEventListener('change', updateCalendarView);
                studentCalendarYear.addEventListener('change', updateCalendarView);

                // Settings form
                studentSettingsForm.addEventListener('submit', (e) => {
                    e.preventDefault();
                    saveStudentSettings();
                });

                // Logout button
                document.getElementById('student-logout-btn').addEventListener('click', (e) => {
                    e.preventDefault();
                    localStorage.removeItem('edutrackLoggedIn');
                    localStorage.removeItem('edutrackUserRole');
                    location.reload();
                });
            }

            // Show/hide student sections
            function showStudentSection(sectionId) {
                studentSections.forEach(section => {
                    section.classList.add('hidden');
                    if (section.id === sectionId) {
                        section.classList.remove('hidden');
                        studentPageTitle.textContent = getStudentSectionTitle(sectionId);
                        updateStudentSectionContent(sectionId);
                    }
                });
            }

            // Get student section title
            function getStudentSectionTitle(sectionId) {
                const titles = {
                    'student-dashboard': 'Student Dashboard',
                    'student-profile': 'Student Profile',
                    'student-attendance': 'Attendance Records',
                    'student-schedule': 'Class Schedule',
                    'student-settings': 'Student Settings'
                };
                return titles[sectionId] || 'Student Dashboard';
            }

            // Update student section-specific content
            function updateStudentSectionContent(sectionId) {
                switch(sectionId) {
                    case 'student-dashboard':
                        updateStudentDashboard();
                        break;
                    case 'student-profile':
                        updateStudentProfile();
                        break;
                    case 'student-attendance':
                        updateStudentAttendanceSection();
                        break;
                    case 'student-schedule':
                        updateStudentSchedule();
                        break;
                    case 'student-settings':
                        updateStudentSettings();
                        break;
                }
            }

            // Update the entire student UI
            function updateStudentUI() {
                updateStudentProfileDisplay();
                updateStudentDashboard();
                updateStudentProfile();
                updateStudentAttendanceSection();
                updateStudentSchedule();
            }

            // Update student profile display in header
            function updateStudentProfileDisplay() {
                studentUserAvatar.textContent = studentData.name.charAt(0);
                studentUserName.textContent = studentData.name;
            }

            // Update student dashboard statistics and content
            function updateStudentDashboard() {
                // Get all attendance records for this student
                const studentAttendance = getStudentAttendanceRecords();
                
                // Calculate statistics
                const subjects = getStudentSubjects();
                studentTotalSubjectsEl.textContent = subjects.length;
                
                const presentDays = studentAttendance.filter(record => record.status === 'present').length;
                const absentDays = studentAttendance.filter(record => record.status === 'absent').length;
                const lateDays = studentAttendance.filter(record => record.status === 'late').length;
                
                studentPresentDaysEl.textContent = presentDays;
                studentAbsentDaysEl.textContent = absentDays + lateDays;
                
                const totalDays = studentAttendance.length;
                const overallAttendance = totalDays > 0 ? Math.round((presentDays / totalDays) * 100) : 0;
                studentOverallAttendanceEl.textContent = `${overallAttendance}%`;
                
                // Update attendance summary by subject
                updateAttendanceSummary(subjects, studentAttendance);
                
                // Update recent attendance table
                updateStudentRecentAttendanceTable(studentAttendance);
            }

            // Get all attendance records for the current student
            function getStudentAttendanceRecords() {
                const savedAttendance = localStorage.getItem('attendanceRecords');
                const attendanceRecords = savedAttendance ? JSON.parse(savedAttendance) : [];
                
                const studentRecords = [];
                
                attendanceRecords.forEach(record => {
                    const studentRecord = record.records.find(r => r.studentId === studentData.id);
                    if (studentRecord) {
                        studentRecords.push({
                            date: record.date,
                            subjectId: record.subjectId,
                            classId: record.classId,
                            status: studentRecord.status
                        });
                    }
                });
                
                return studentRecords;
            }

            // Get all subjects for the current student
            function getStudentSubjects() {
                const savedSubjects = localStorage.getItem('subjects');
                const allSubjects = savedSubjects ? JSON.parse(savedSubjects) : [];
                
                return allSubjects.filter(subject => subject.classId === studentData.classId);
            }

            // Update attendance summary by subject
            function updateAttendanceSummary(subjects, studentAttendance) {
                attendanceSummary.innerHTML = '';
                
                subjects.forEach(subject => {
                    const subjectAttendance = studentAttendance.filter(record => record.subjectId === subject.id);
                    const totalClasses = subjectAttendance.length;
                    const presentClasses = subjectAttendance.filter(record => record.status === 'present').length;
                    const attendanceRate = totalClasses > 0 ? Math.round((presentClasses / totalClasses) * 100) : 0;
                    
                    const card = document.createElement('div');
                    card.className = 'attendance-card';
                    
                    card.innerHTML = `
                        <div class="subject-name">${subject.name}</div>
                        <div class="attendance-percentage">${attendanceRate}%</div>
                        <div class="attendance-bar">
                            <div class="attendance-progress" style="width: ${attendanceRate}%"></div>
                        </div>
                        <p>${presentClasses}/${totalClasses} classes</p>
                    `;
                    
                    attendanceSummary.appendChild(card);
                });
                
                // If no subjects, show message
                if (subjects.length === 0) {
                    attendanceSummary.innerHTML = '<p class="text-center">No subjects found for your class.</p>';
                }
            }

            // Update student recent attendance table
            function updateStudentRecentAttendanceTable(studentAttendance) {
                studentRecentAttendanceTable.innerHTML = '';
                
                // Show only the 10 most recent records
                const recentRecords = [...studentAttendance]
                    .sort((a, b) => new Date(b.date) - new Date(a.date))
                    .slice(0, 10);
                
                recentRecords.forEach(record => {
                    const subject = getSubjectById(record.subjectId);
                    
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${formatDisplayDate(record.date)}</td>
                        <td>${subject ? subject.name : record.subjectId}</td>
                        <td><span class="attendance-status status-${record.status}">${record.status.charAt(0).toUpperCase() + record.status.slice(1)}</span></td>
                    `;
                    studentRecentAttendanceTable.appendChild(row);
                });
                
                // If no records, show message
                if (recentRecords.length === 0) {
                    studentRecentAttendanceTable.innerHTML = '<tr><td colspan="3" class="text-center">No attendance records found.</td></tr>';
                }
            }

            // Update student profile form with current data
            function updateStudentProfile() {
                studentProfileNameInput.value = studentData.name;
                studentProfileIdInput.value = studentData.id;
                studentProfileEmailInput.value = studentData.email;
                
                // Get class name
                const savedClasses = localStorage.getItem('classes');
                const classes = savedClasses ? JSON.parse(savedClasses) : [];
                const studentClass = classes.find(c => c.id === studentData.classId);
                studentProfileClassInput.value = studentClass ? studentClass.name : studentData.classId;
                
                studentProfilePhoneInput.value = studentData.phone || '';
            }

            // Update student attendance section
            function updateStudentAttendanceSection() {
                const studentAttendance = getStudentAttendanceRecords();
                updateStudentAttendanceTable(studentAttendance);
                updateStudentSubjectSelect();
            }

            // Update student attendance table
            function updateStudentAttendanceTable(studentAttendance) {
                studentAttendanceTable.innerHTML = '';
                
                studentAttendance.forEach(record => {
                    const subject = getSubjectById(record.subjectId);
                    const classObj = getClassById(record.classId);
                    
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${formatDisplayDate(record.date)}</td>
                        <td>${subject ? subject.name : record.subjectId}</td>
                        <td>${classObj ? classObj.name : record.classId}</td>
                        <td><span class="attendance-status status-${record.status}">${record.status.charAt(0).toUpperCase() + record.status.slice(1)}</span></td>
                    `;
                    studentAttendanceTable.appendChild(row);
                });
                
                // If no records, show message
                if (studentAttendance.length === 0) {
                    studentAttendanceTable.innerHTML = '<tr><td colspan="4" class="text-center">No attendance records found.</td></tr>';
                }
            }

            // Update student subject select options
            function updateStudentSubjectSelect() {
                studentSubjectSelect.innerHTML = '<option value="">-- Select Subject --</option>';
                
                const subjects = getStudentSubjects();
                subjects.forEach(subject => {
                    const option = document.createElement('option');
                    option.value = subject.id;
                    option.textContent = subject.name;
                    studentSubjectSelect.appendChild(option);
                });
            }

            // Show subject-specific attendance details
            function showSubjectAttendanceDetails() {
                const subjectId = studentSubjectSelect.value;
                
                if (!subjectId) {
                    subjectAttendanceDetails.classList.add('hidden');
                    return;
                }
                
                const subject = getSubjectById(subjectId);
                if (!subject) return;
                
                selectedSubjectName.textContent = subject.name;
                
                const studentAttendance = getStudentAttendanceRecords();
                const subjectAttendance = studentAttendance.filter(record => record.subjectId === subjectId);
                
                // Update attendance grid
                subjectAttendanceGrid.innerHTML = '';
                
                subjectAttendance.forEach(record => {
                    const statusDot = document.createElement('div');
                    statusDot.className = `status-dot status-${record.status}`;
                    statusDot.title = `${formatDisplayDate(record.date)}: ${record.status}`;
                    subjectAttendanceGrid.appendChild(statusDot);
                });
                
                // Calculate statistics
                const totalClasses = subjectAttendance.length;
                const presentCount = subjectAttendance.filter(record => record.status === 'present').length;
                const absentCount = subjectAttendance.filter(record => record.status === 'absent').length;
                const lateCount = subjectAttendance.filter(record => record.status === 'late').length;
                const attendanceRate = totalClasses > 0 ? Math.round((presentCount / totalClasses) * 100) : 0;
                
                subjectTotalClasses.textContent = totalClasses;
                subjectPresentCount.textContent = presentCount;
                subjectAbsentCount.textContent = absentCount;
                subjectLateCount.textContent = lateCount;
                subjectAttendanceRate.textContent = `${attendanceRate}%`;
                
                subjectAttendanceDetails.classList.remove('hidden');
            }

            // Update student schedule
            function updateStudentSchedule() {
                studentScheduleTable.innerHTML = '';
                
                // For demo purposes, we'll create a sample schedule
                // In a real application, this would come from the database
                const sampleSchedule = [
                    { subject: 'Programming Fundamentals', day: 'Monday', time: '9:00 AM - 10:30 AM', room: 'CS-101' },
                    { subject: 'Database Systems', day: 'Monday', time: '11:00 AM - 12:30 PM', room: 'CS-102' },
                    { subject: 'Programming Fundamentals', day: 'Wednesday', time: '9:00 AM - 10:30 AM', room: 'CS-101' },
                    { subject: 'Mathematics', day: 'Wednesday', time: '11:00 AM - 12:30 PM', room: 'MATH-201' },
                    { subject: 'Database Systems', day: 'Friday', time: '9:00 AM - 10:30 AM', room: 'CS-102' },
                    { subject: 'Mathematics', day: 'Friday', time: '11:00 AM - 12:30 PM', room: 'MATH-201' }
                ];
                
                sampleSchedule.forEach(item => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${item.subject}</td>
                        <td>${item.day}</td>
                        <td>${item.time}</td>
                        <td>${item.room}</td>
                    `;
                    studentScheduleTable.appendChild(row);
                });
            }

            // Update student settings form
            function updateStudentSettings() {
                studentNotificationsInput.checked = studentSettings.notifications;
                studentEmailAlertsInput.checked = studentSettings.emailAlerts;
                studentThemeInput.value = studentSettings.theme;
            }

            // Save student settings
            function saveStudentSettings() {
                studentSettings.notifications = studentNotificationsInput.checked;
                studentSettings.emailAlerts = studentEmailAlertsInput.checked;
                studentSettings.theme = studentThemeInput.value;
                
                localStorage.setItem('studentSettings', JSON.stringify(studentSettings));
                applyTheme();
                alert('Settings saved successfully!');
            }

            // Apply theme based on settings
            function applyTheme() {
                const theme = studentSettings.theme;
                
                if (theme === 'dark') {
                    document.documentElement.style.setProperty('--primary', '#FF6B8B');
                    document.documentElement.style.setProperty('--secondary', '#2D3748');
                    document.documentElement.style.setProperty('--accent', '#FFA586');
                    document.documentElement.style.setProperty('--light', '#1A202C');
                    document.documentElement.style.setProperty('--dark', '#F7FAFC');
                    document.body.style.backgroundColor = '#1A202C';
                    document.body.style.color = '#F7FAFC';
                } else if (theme === 'light') {
                    document.documentElement.style.setProperty('--primary', '#B12F49');
                    document.documentElement.style.setProperty('--secondary', '#384358');
                    document.documentElement.style.setProperty('--accent', '#FFA586');
                    document.documentElement.style.setProperty('--light', '#f8f9fa');
                    document.documentElement.style.setProperty('--dark', '#343a40');
                    document.body.style.backgroundColor = '#f5f5f5';
                    document.body.style.color = '#384358';
                } else if (theme === 'auto') {
                    // Auto theme based on system preference
                    if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                        document.documentElement.style.setProperty('--primary', '#FF6B8B');
                        document.documentElement.style.setProperty('--secondary', '#2D3748');
                        document.documentElement.style.setProperty('--accent', '#FFA586');
                        document.documentElement.style.setProperty('--light', '#1A202C');
                        document.documentElement.style.setProperty('--dark', '#F7FAFC');
                        document.body.style.backgroundColor = '#1A202C';
                        document.body.style.color = '#F7FAFC';
                    } else {
                        document.documentElement.style.setProperty('--primary', '#B12F49');
                        document.documentElement.style.setProperty('--secondary', '#384358');
                        document.documentElement.style.setProperty('--accent', '#FFA586');
                        document.documentElement.style.setProperty('--light', '#f8f9fa');
                        document.documentElement.style.setProperty('--dark', '#343a40');
                        document.body.style.backgroundColor = '#f5f5f5';
                        document.body.style.color = '#384358';
                    }
                }
            }

            // Switch between student tabs
            function switchStudentTab(tabId) {
                // Update active tab
                document.querySelectorAll('#student-attendance .tab').forEach(tab => {
                    tab.classList.remove('active');
                    if (tab.getAttribute('data-tab') === tabId) {
                        tab.classList.add('active');
                    }
                });
                
                // Update active tab content
                document.querySelectorAll('#student-attendance .tab-content').forEach(content => {
                    content.classList.remove('active');
                    if (content.id === tabId) {
                        content.classList.add('active');
                        
                        // Update content if needed
                        if (tabId === 'student-calendar') {
                            updateCalendarView();
                        }
                    }
                });
            }

            // Populate year options for calendar
            function populateYearOptions() {
                studentCalendarYear.innerHTML = '';
                
                const currentYear = new Date().getFullYear();
                for (let year = currentYear - 2; year <= currentYear + 1; year++) {
                    const option = document.createElement('option');
                    option.value = year;
                    option.textContent = year;
                    studentCalendarYear.appendChild(option);
                }
            }

            // Update calendar view
            function updateCalendarView() {
                const month = parseInt(studentCalendarMonth.value);
                const year = parseInt(studentCalendarYear.value);
                
                // Create calendar header
                const monthNames = ["January", "February", "March", "April", "May", "June",
                    "July", "August", "September", "October", "November", "December"];
                
                let calendarHTML = `<h4>${monthNames[month]} ${year}</h4>`;
                calendarHTML += `<div class="calendar-view">`;
                
                // Add day headers
                const dayNames = ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"];
                dayNames.forEach(day => {
                    calendarHTML += `<div class="calendar-day" style="font-weight: bold;">${day}</div>`;
                });
                
                // Get first day of month and number of days
                const firstDay = new Date(year, month, 1).getDay();
                const daysInMonth = new Date(year, month + 1, 0).getDate();
                
                // Add empty cells for days before the first day of the month
                for (let i = 0; i < firstDay; i++) {
                    calendarHTML += `<div class="calendar-day no-class"></div>`;
                }
                
                // Add cells for each day of the month
                const studentAttendance = getStudentAttendanceRecords();
                
                for (let day = 1; day <= daysInMonth; day++) {
                    const date = new Date(year, month, day);
                    const dateString = formatDate(date);
                    
                    // Check if there's attendance for this date
                    const attendanceRecord = studentAttendance.find(record => record.date === dateString);
                    
                    let dayClass = 'calendar-day';
                    let dayTitle = `${day}`;
                    
                    if (attendanceRecord) {
                        dayClass += ` ${attendanceRecord.status}`;
                        const subject = getSubjectById(attendanceRecord.subjectId);
                        dayTitle += ` - ${subject ? subject.name : attendanceRecord.subjectId}: ${attendanceRecord.status}`;
                    } else {
                        dayClass += ' no-class';
                        dayTitle += ' - No class';
                    }
                    
                    calendarHTML += `<div class="${dayClass}" title="${dayTitle}">${day}</div>`;
                }
                
                calendarHTML += `</div>`;
                studentCalendarView.innerHTML = calendarHTML;
            }

            // Helper functions
            function getSubjectById(subjectId) {
                const savedSubjects = localStorage.getItem('subjects');
                const subjects = savedSubjects ? JSON.parse(savedSubjects) : [];
                return subjects.find(subject => subject.id === subjectId);
            }

            function getClassById(classId) {
                const savedClasses = localStorage.getItem('classes');
                const classes = savedClasses ? JSON.parse(savedClasses) : [];
                return classes.find(classObj => classObj.id === classId);
            }

            function formatDate(date) {
                return date.toISOString().split('T')[0];
            }

            function formatDisplayDate(dateString) {
                const date = new Date(dateString);
                return date.toLocaleDateString('en-US', { 
                    year: 'numeric', 
                    month: 'short', 
                    day: 'numeric' 
                });
            }

            // Initialize the student dashboard
            init();
        }
    </script>
</body>
</html>